@* The Razor component to delete Department *@

@page "/deletedept/{DeptId}"
@inject IStudentService StudentService
@inject IDepartmentService DepartmentService
@inject NavigationManager NavigationManager

<PageTitle>Delete Department</PageTitle>
<h3> Delete Department Details</h3>
<hr />
@if(obj!=null){
<form>
    <div class="row">
        <div class="col-md-8">
            <div class="form-group">
                <label for="Id" class="control-lablel">Department Id</label>
                <label>@obj.DeptId</label> 
            </div>
            <div class="form-group">
                <label for="Name" class="control-lablel">Department Name</label>
                <label>@obj.DeptName</label> 
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-4">
            <div class="form-group">
                <input type="button" class="btn btn-primary" @onclick="DeleteDepartmentRecord" value="Delete Department" />
                <input type="button" class="btn btn-danger" @onclick = "Discard" value="Discard" />
            </div>
        </div>
    </div>
</form>
}
else{
    <div class="spinner">

    </div>
}

@code{

    [Parameter]
    public string DeptId{get; set;}
    int Id;
    Department obj = new Department();

    protected override async Task OnInitializedAsync()
    {
        if(int.TryParse(DeptId,out Id)){
            obj = await DepartmentService.GetDepartmentById(Id);
            if(obj==null){
                NavigationManager.NavigateTo("/error");
            }
        }
        else{
            NavigationManager.NavigateTo("/error");
        }
    }
    protected async void DeleteDepartmentRecord()
    {
        if(int.TryParse(DeptId,out Id)){
            await DepartmentService.DeleteDepartment(Id);
            NavigationManager.NavigateTo("Department");            
        }
        else{
            NavigationManager.NavigateTo("/error");
        }
        
    }
    protected async void Discard()
    {
        NavigationManager.NavigateTo("Department");
    }
}